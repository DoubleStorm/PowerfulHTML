<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<title>FunctionPages</title>
	<link rel="Shortcut Icon" href="./asset/img/ICON-s.png">  
	<link rel="Bookmark" href="./asset/img/ICON-s.png">
	<style>
		body{
			width: 100vw;
			height: 100vh;
			margin: 0;
			bottom: 0;
			display: flex;
			justify-content: center;
			align-items: center;
			-moz-user-select: none;
			-webkit-user-select: none;
		}
		.notes{
			width: max-content;
			height: max-content;
			display: flex;
			justify-content: center;
			position: relative;
			height: 454px;
			min-width: 130px;
			background: linear-gradient(-45deg,black 0,black 25%,transparent 0) left top / 10px 10px;
		}
		.notes .set{
			width: max-content;
			height: max-content;
			position: absolute;
			right: -30px;
			top: 1px;
			line-height: 14px;
			padding: 0;
		}
		.notes .addNote{
			position: absolute;
			right: -58px;
			top: 200px;
			line-height: 14px;
			padding: 0;
		}
		.notes .note{
			height: 450px;
			width: 130px;
			transition: all .2s linear;
			border-width: 2px;
			border-style: solid;
			border-right-width: 0;
			border-left-width: 0;
			position: relative;
		}
		.notes div:first-of-type{
			border-left-width: 2px;
		}
		.notes div:last-of-type{
			border-right-width: 2px;
		}
		.notes .selected{
			width: 320px;
		}
		.note span.title{
			display: inline-block;
			width: 100%;
			height: 80px;
			font-size: 26px;
			white-space: nowrap;
			text-overflow: ellipsis;
			overflow: hidden;
			text-align: center;
			color: #fff;
			line-height: 80px;
			border-bottom: 1px dashed #fff;
			padding: 0 5px;
			box-sizing: border-box;
		}
		.note ul{
			width: 100%;
			height: calc(100% - 81px);
			padding: 20px 0 20px 10px;
			box-sizing: border-box;
			margin: 0;
			list-style-type: none;
			list-style-position: inside;
		}
		.note ul li{
			width: 100%;
			height: max-content;
			white-space: nowrap;
			text-overflow: ellipsis;
			overflow: hidden;
			margin-bottom: 5px;
			padding-right: 16px;
			padding-left: 10px;
			box-sizing: border-box;
			position: relative;
		}
		.note div.deleteTask{
			position: absolute;
			top: 0;
			right: 2px;
		}
		.note div.addTask{
			position: absolute;
			bottom: 2px;
			left: 5px;
		}
		.note li .tags{
			width: max-content;
			position: absolute;
			left: 0;
			top: 50%;
			width: 6px;
			height: max-content;
			transform: translateY(-50%);
			background: #eee;
			min-height: 2px;
		}
		.note div.deleteNote{
			position: absolute;
			top: 5px;
			right: 5px;
			font-size: 20px;
			cursor: pointer;
		}
		.note div.setTask{
			position: absolute;
			top:82px;
			right: 5px;
			font-size: 18px;
			cursor: pointer;
		}
		.setTask img{
			width: 15px;
			height: 15px;
		}
		.blue{
			border-color: rgb(23, 123, 253);
			background-color: rgb(132, 185, 255);
			color: rgb(0, 30, 75);
		}
		.red{
			border-color: rgb(255, 32, 32);
			background-color: rgb(255, 125, 125);
			color: rgb(114, 0, 0);
		}
		.green{
			border-color: rgb(27, 231, 44);
			background-color: rgb(142, 233, 149);
			color: rgb(0, 104, 9);
		}
		.orange{
			border-color: rgb(255, 149, 28);
			background-color: rgb(255, 184, 103);
			color: rgb(104, 55, 0);
		}
		.gray{
			border-color: rgb(99, 99, 99);
			background-color: rgb(161, 161, 161);
			color: rgb(61, 61, 61);
		}
		.peach{
			border-color: rgb(255, 81, 162);
			background-color: rgb(255, 172, 211);
			color: rgb(114, 1, 53);
		}
		.violet{
			border-color: rgb(203, 33, 255);
			background-color: rgb(225, 126, 255);
			color: rgb(76, 0, 99);
		}
		.tags span{
			display: block;
			white-space: normal;
			width: 100%;
			height: 3px;
			margin: 1px 0;
			box-sizing: border-box;
		}
		.tags .urgent{
			background-color: rgb(167, 0, 0);
		}
		.tags .insistent{
			background-color: rgb(0, 2, 129);
		}
		.tags .helpful{
			background-color: rgb(0, 129, 0);
		}
		.displayNone{
			display: none;
		}
	</style>
</head>
<body>
	<div class="notes">
		<span class="set" onclick="toggleSetNote();">
			<svg t="1600596094115" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4671" width="25" height="25">
				<path d="M671.565913 961.825391c-36.018087 0-67.517217-14.425043-84.702609-42.362435l-40.603826-66.048c-20.279652-1.491478-61.640348 1.246609-79.248696 6.099478l-28.293565 52.335304c-25.35513 46.814609-92.42713 62.530783-149.659826 35.149913-60.104348-28.226783-94.875826-60.838957-104.759652-97.658435-4.474435-16.62887-5.743304-42.162087 12.955826-70.099478l35.995826-66.493217c-7.43513-17.942261-28.204522-51.734261-40.470261-65.847652l-63.866435 1.736348c-54.761739 1.113043-102.466783-52.357565-106.317913-120.07513-6.188522-90.067478 30.875826-149.192348 96.678957-155.158261l73.638957-2.070261c12.577391-14.425043 34.192696-51.021913 41.427478-69.943652l-32.345043-52.602435c-30.430609-49.530435-2.715826-119.986087 63.087304-160.411826 65.80313-40.425739 141.178435-33.324522 171.586783 16.183652l34.726957 56.475826c19.656348 3.940174 66.582261 4.006957 86.950957 0.111304l30.675478-55.852522c30.675478-45.367652 102.15513-53.426087 166.266435-18.721391 30.297043 16.406261 54.717217 40.225391 68.786087 67.094261 16.11687 30.764522 17.185391 63.421217 3.027478 89.622261l-32.01113 59.102609c8.214261 19.634087 34.170435 60.505043 48.573217 74.418087l57.299478-1.380174 1.558261 0.111304c54.717217 3.82887 97.458087 61.70713 99.439304 134.656 0.957217 34.415304-7.457391 67.472696-23.685565 93.094957-18.587826 29.317565-46.32487 46.592-76.109913 47.393391l-72.659478 2.003478c-12.288 18.142609-31.833043 59.503304-35.483826 77.779478l28.360348 46.235826c28.42713 50.198261 0.089043 119.56313-63.955478 158.920348C729.822609 953.232696 699.347478 961.825391 671.565913 961.825391zM527.09287 786.342957c24.175304 0 45.367652 2.56 55.140174 7.501913l8.45913 4.251826 53.092174 86.372174c7.835826 12.777739 42.874435 16.962783 79.738435-5.765565 36.730435-22.572522 48.862609-54.873043 41.360696-68.096l-35.951304-58.61287-1.179826-5.765565c-8.036174-39.290435 42.985739-138.573913 68.786087-154.802087l7.746783-4.87513 96.077913-2.649043c10.217739-0.289391 18.454261-11.575652 21.526261-16.406261 9.060174-14.313739 13.935304-34.526609 13.378783-55.518609-1.113043-40.759652-21.504-67.517217-36.262957-69.743304l-70.767304 1.669565-5.988174-2.203826c-35.862261-13.245217-96.968348-111.304348-96.01113-144.873739l0.222609-7.94713 41.939478-77.467826c4.87513-8.97113-0.77913-21.77113-3.428174-26.846609-7.880348-15.003826-22.950957-29.339826-41.405217-39.334957l0 0c-35.795478-19.366957-69.164522-15.09287-78.514087-3.472696l-37.798957 69.275826-6.455652 4.496696c-29.517913 20.524522-141.267478 20.591304-170.829913 0.111304L424.18087 211.70087l-44.365913-72.192c-7.880348-12.777739-42.829913-16.918261-79.738435 5.743304-36.886261 22.683826-49.018435 55.741217-41.138087 68.563478l44.009739 71.590957 0.311652 8.815304c1.202087 33.413565-52.869565 124.994783-82.632348 139.998609l-6.656 3.33913-90.735304 2.493217c-34.081391 3.161043-36.062609 53.403826-34.03687 83.055304 2.137043 37.286957 23.129043 58.790957 37.531826 58.790957 0.133565 0 0.26713 0 0.400696 0l85.103304-2.31513 7.524174 3.784348c31.076174 15.693913 82.142609 103.067826 82.565565 133.209043l0.111304 8.704-49.174261 90.423652c-6.366609 9.126957-5.053217 14.002087-4.429913 16.339478 3.294609 12.332522 22.706087 32.923826 67.205565 53.826783 30.586435 14.714435 57.410783 6.299826 63.955478-5.810087l36.953043-68.274087 5.587478-4.318609C441.143652 793.088 488.002783 786.342957 527.09287 786.342957z" p-id="4672"></path><path d="M509.306435 687.571478c-95.98887 0-174.08-78.113391-174.08-174.102261s78.09113-174.102261 174.08-174.102261 174.102261 78.09113 174.102261 174.102261S605.295304 687.571478 509.306435 687.571478zM509.306435 406.149565c-59.169391 0-107.297391 48.150261-107.297391 107.319652 0 59.191652 48.128 107.319652 107.297391 107.319652s107.319652-48.150261 107.319652-107.319652C616.626087 454.277565 568.475826 406.149565 509.306435 406.149565z" p-id="4673"></path>
			</svg>
		</span>
		<span class="addNote displayNone" onclick="addNote();">
			<svg t="1600597352669" class="icon" viewBox="0 0 1026 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5425" width="50" height="50">
				<path d="M511.17819 1023.449171C232.458621 1030.059121-1.643784 782.185986 0.008703 508.974708 1.661191 236.865089 239.068571-1.64395 516.135653 0.008538c271.55879 1.652488 510.618658 239.059868 508.966171 516.12695C1023.449336 787.694278 787.694443 1031.711609 511.17819 1023.449171zM491.34834 97.505304c-195.544362-1.652488-418.630184 188.383583-394.944528 457.188227 15.974046 181.222803 190.03607 398.249504 459.942373 374.013019 181.773632-16.524876 396.046187-190.586899 371.809703-459.391544C911.080182 278.177278 730.408208 79.327941 491.34834 97.505304z" p-id="5426"></path><path d="M560.201988 362.454144c0 27.541459 0.550829 55.082919 0 82.624378-0.550829 15.423217 5.508292 20.38068 20.38068 19.829851 55.082919-0.550829 110.165838 0 165.248757-0.550829 15.974046 0 22.583997 4.406634 21.482338 20.931509-1.101658 18.728192-1.101658 37.456385 0 55.633748 0.550829 14.872388-5.508292 19.279022-19.279022 18.728192-55.082919-0.550829-110.165838 0-165.248757-0.550829-16.524876 0-23.134826 4.957463-22.583997 22.033168 1.101658 54.53209 0 108.51335 0.550829 163.04544 0.550829 17.626534-6.059121 23.134826-22.583997 22.033168-17.075705-1.101658-34.702239-1.101658-51.777944 0-15.974046 1.101658-21.482338-4.957463-21.482338-21.482338 0.550829-53.430431-0.550829-107.411692 0.550829-160.842123 0.550829-20.38068-6.60995-25.888972-25.888972-25.338143-53.430431 1.101658-107.411692 0-160.842123 0.550829-14.872388 0-21.482338-4.406634-20.38068-19.829851 1.101658-18.728192 1.101658-37.456385 0-55.633748-1.101658-15.974046 5.508292-19.829851 20.38068-19.829851 54.53209 0.550829 108.51335-0.550829 163.04544 0.550829 17.626534 0.550829 24.236484-4.406634 23.685655-23.134826-1.101658-54.53209 0-108.51335-0.550829-163.04544 0-16.524876 5.508292-22.033168 21.482338-21.482338 17.626534 1.101658 35.803897 1.101658 53.430431 0 14.872388-0.550829 20.931509 4.406634 20.38068 19.829851C559.651159 306.269567 560.201988 334.361856 560.201988 362.454144z" p-id="5427"></path>
			</svg>
		</span>
	</div>
<script>
var SETTING = {
	noteColor: ['blue','red','green','orange','gray','peach','violet'],  // 新建 note 的可用样式
	noteCount: 7, 	// 最多允许创建的分类数量
	taskCount: 12,  // 给个分类下允许创建的任务数量
	nowNote:0,  	// 当前 note 的数量
	nowTask:[],     // 当前各 note 中 task 的数量
}
var baseDom = {
	noteInnerHtml : `
		<div class="deleteNote displayNone" onclick="deleteNote(this);">
			<svg t="1600595846380" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3916" width="20" height="20">
				<path d="M898 178.7H665.3c4.3-9.8 6.7-20.6 6.7-32 0-44-36-80-80-80H432c-44 0-80 36-80 80 0 11.4 2.4 22.2 6.7 32H126c-13.2 0-24 10.8-24 24s10.8 24 24 24h772c13.2 0 24-10.8 24-24s-10.8-24-24-24z m-466 0c-8.5 0-16.5-3.4-22.6-9.4-6.1-6.1-9.4-14.1-9.4-22.6s3.4-16.5 9.4-22.6c6.1-6.1 14.1-9.4 22.6-9.4h160c8.5 0 16.5 3.4 22.6 9.4 6.1 6.1 9.4 14.1 9.4 22.6 0 8.5-3.4 16.5-9.4 22.6-6.1 6.1-14.1 9.4-22.6 9.4H432zM513 774.7c18.1 0 33-14.8 33-33v-334c0-18.1-14.9-33-33-33h-2c-18.1 0-33 14.8-33 33v334c0 18.2 14.8 33 33 33h2zM363 774.7c18.1 0 33-14.8 33-33v-334c0-18.1-14.9-33-33-33h-2c-18.1 0-33 14.8-33 33v334c0 18.2 14.8 33 33 33h2zM663 774.7c18.1 0 33-14.8 33-33v-334c0-18.1-14.9-33-33-33h-2c-18.1 0-33 14.8-33 33v334c0 18.2 14.8 33 33 33h2z" p-id="3917"></path><path d="M812 280.7c-13.3 0-24 10.7-24 24v530c0 41.9-34.1 76-76 76H312c-41.9 0-76-34.1-76-76v-530c0-13.3-10.7-24-24-24s-24 10.7-24 24v530c0 68.4 55.6 124 124 124h400c68.4 0 124-55.6 124-124v-530c0-13.2-10.7-24-24-24z" p-id="3918"></path>
			</svg>
		</div>
		<div class="setTask" onclick="toggleSetTask(this);">
			<svg t="1600596094115" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4671" width="16" height="16">
				<path d="M671.565913 961.825391c-36.018087 0-67.517217-14.425043-84.702609-42.362435l-40.603826-66.048c-20.279652-1.491478-61.640348 1.246609-79.248696 6.099478l-28.293565 52.335304c-25.35513 46.814609-92.42713 62.530783-149.659826 35.149913-60.104348-28.226783-94.875826-60.838957-104.759652-97.658435-4.474435-16.62887-5.743304-42.162087 12.955826-70.099478l35.995826-66.493217c-7.43513-17.942261-28.204522-51.734261-40.470261-65.847652l-63.866435 1.736348c-54.761739 1.113043-102.466783-52.357565-106.317913-120.07513-6.188522-90.067478 30.875826-149.192348 96.678957-155.158261l73.638957-2.070261c12.577391-14.425043 34.192696-51.021913 41.427478-69.943652l-32.345043-52.602435c-30.430609-49.530435-2.715826-119.986087 63.087304-160.411826 65.80313-40.425739 141.178435-33.324522 171.586783 16.183652l34.726957 56.475826c19.656348 3.940174 66.582261 4.006957 86.950957 0.111304l30.675478-55.852522c30.675478-45.367652 102.15513-53.426087 166.266435-18.721391 30.297043 16.406261 54.717217 40.225391 68.786087 67.094261 16.11687 30.764522 17.185391 63.421217 3.027478 89.622261l-32.01113 59.102609c8.214261 19.634087 34.170435 60.505043 48.573217 74.418087l57.299478-1.380174 1.558261 0.111304c54.717217 3.82887 97.458087 61.70713 99.439304 134.656 0.957217 34.415304-7.457391 67.472696-23.685565 93.094957-18.587826 29.317565-46.32487 46.592-76.109913 47.393391l-72.659478 2.003478c-12.288 18.142609-31.833043 59.503304-35.483826 77.779478l28.360348 46.235826c28.42713 50.198261 0.089043 119.56313-63.955478 158.920348C729.822609 953.232696 699.347478 961.825391 671.565913 961.825391zM527.09287 786.342957c24.175304 0 45.367652 2.56 55.140174 7.501913l8.45913 4.251826 53.092174 86.372174c7.835826 12.777739 42.874435 16.962783 79.738435-5.765565 36.730435-22.572522 48.862609-54.873043 41.360696-68.096l-35.951304-58.61287-1.179826-5.765565c-8.036174-39.290435 42.985739-138.573913 68.786087-154.802087l7.746783-4.87513 96.077913-2.649043c10.217739-0.289391 18.454261-11.575652 21.526261-16.406261 9.060174-14.313739 13.935304-34.526609 13.378783-55.518609-1.113043-40.759652-21.504-67.517217-36.262957-69.743304l-70.767304 1.669565-5.988174-2.203826c-35.862261-13.245217-96.968348-111.304348-96.01113-144.873739l0.222609-7.94713 41.939478-77.467826c4.87513-8.97113-0.77913-21.77113-3.428174-26.846609-7.880348-15.003826-22.950957-29.339826-41.405217-39.334957l0 0c-35.795478-19.366957-69.164522-15.09287-78.514087-3.472696l-37.798957 69.275826-6.455652 4.496696c-29.517913 20.524522-141.267478 20.591304-170.829913 0.111304L424.18087 211.70087l-44.365913-72.192c-7.880348-12.777739-42.829913-16.918261-79.738435 5.743304-36.886261 22.683826-49.018435 55.741217-41.138087 68.563478l44.009739 71.590957 0.311652 8.815304c1.202087 33.413565-52.869565 124.994783-82.632348 139.998609l-6.656 3.33913-90.735304 2.493217c-34.081391 3.161043-36.062609 53.403826-34.03687 83.055304 2.137043 37.286957 23.129043 58.790957 37.531826 58.790957 0.133565 0 0.26713 0 0.400696 0l85.103304-2.31513 7.524174 3.784348c31.076174 15.693913 82.142609 103.067826 82.565565 133.209043l0.111304 8.704-49.174261 90.423652c-6.366609 9.126957-5.053217 14.002087-4.429913 16.339478 3.294609 12.332522 22.706087 32.923826 67.205565 53.826783 30.586435 14.714435 57.410783 6.299826 63.955478-5.810087l36.953043-68.274087 5.587478-4.318609C441.143652 793.088 488.002783 786.342957 527.09287 786.342957z" p-id="4672"></path><path d="M509.306435 687.571478c-95.98887 0-174.08-78.113391-174.08-174.102261s78.09113-174.102261 174.08-174.102261 174.102261 78.09113 174.102261 174.102261S605.295304 687.571478 509.306435 687.571478zM509.306435 406.149565c-59.169391 0-107.297391 48.150261-107.297391 107.319652 0 59.191652 48.128 107.319652 107.297391 107.319652s107.319652-48.150261 107.319652-107.319652C616.626087 454.277565 568.475826 406.149565 509.306435 406.149565z" p-id="4673"></path>
			</svg>
		</div>
		<div class="addTask displayNone" onclick="addTask(this);">
			<svg t="1600597352669" class="icon" viewBox="0 0 1026 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5425" width="14" height="14">
				<path d="M511.17819 1023.449171C232.458621 1030.059121-1.643784 782.185986 0.008703 508.974708 1.661191 236.865089 239.068571-1.64395 516.135653 0.008538c271.55879 1.652488 510.618658 239.059868 508.966171 516.12695C1023.449336 787.694278 787.694443 1031.711609 511.17819 1023.449171zM491.34834 97.505304c-195.544362-1.652488-418.630184 188.383583-394.944528 457.188227 15.974046 181.222803 190.03607 398.249504 459.942373 374.013019 181.773632-16.524876 396.046187-190.586899 371.809703-459.391544C911.080182 278.177278 730.408208 79.327941 491.34834 97.505304z" p-id="5426"></path><path d="M560.201988 362.454144c0 27.541459 0.550829 55.082919 0 82.624378-0.550829 15.423217 5.508292 20.38068 20.38068 19.829851 55.082919-0.550829 110.165838 0 165.248757-0.550829 15.974046 0 22.583997 4.406634 21.482338 20.931509-1.101658 18.728192-1.101658 37.456385 0 55.633748 0.550829 14.872388-5.508292 19.279022-19.279022 18.728192-55.082919-0.550829-110.165838 0-165.248757-0.550829-16.524876 0-23.134826 4.957463-22.583997 22.033168 1.101658 54.53209 0 108.51335 0.550829 163.04544 0.550829 17.626534-6.059121 23.134826-22.583997 22.033168-17.075705-1.101658-34.702239-1.101658-51.777944 0-15.974046 1.101658-21.482338-4.957463-21.482338-21.482338 0.550829-53.430431-0.550829-107.411692 0.550829-160.842123 0.550829-20.38068-6.60995-25.888972-25.888972-25.338143-53.430431 1.101658-107.411692 0-160.842123 0.550829-14.872388 0-21.482338-4.406634-20.38068-19.829851 1.101658-18.728192 1.101658-37.456385 0-55.633748-1.101658-15.974046 5.508292-19.829851 20.38068-19.829851 54.53209 0.550829 108.51335-0.550829 163.04544 0.550829 17.626534 0.550829 24.236484-4.406634 23.685655-23.134826-1.101658-54.53209 0-108.51335-0.550829-163.04544 0-16.524876 5.508292-22.033168 21.482338-21.482338 17.626534 1.101658 35.803897 1.101658 53.430431 0 14.872388-0.550829 20.931509 4.406634 20.38068 19.829851C559.651159 306.269567 560.201988 334.361856 560.201988 362.454144z" p-id="5427"></path>
			</svg>
		</div>`,
	liInnerHtml:`
		<div class="deleteTask displayNone" onclick="deleteTask(this);">
			<svg t="1600595846380" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3916" width="14" height="14">
				<path d="M898 178.7H665.3c4.3-9.8 6.7-20.6 6.7-32 0-44-36-80-80-80H432c-44 0-80 36-80 80 0 11.4 2.4 22.2 6.7 32H126c-13.2 0-24 10.8-24 24s10.8 24 24 24h772c13.2 0 24-10.8 24-24s-10.8-24-24-24z m-466 0c-8.5 0-16.5-3.4-22.6-9.4-6.1-6.1-9.4-14.1-9.4-22.6s3.4-16.5 9.4-22.6c6.1-6.1 14.1-9.4 22.6-9.4h160c8.5 0 16.5 3.4 22.6 9.4 6.1 6.1 9.4 14.1 9.4 22.6 0 8.5-3.4 16.5-9.4 22.6-6.1 6.1-14.1 9.4-22.6 9.4H432zM513 774.7c18.1 0 33-14.8 33-33v-334c0-18.1-14.9-33-33-33h-2c-18.1 0-33 14.8-33 33v334c0 18.2 14.8 33 33 33h2zM363 774.7c18.1 0 33-14.8 33-33v-334c0-18.1-14.9-33-33-33h-2c-18.1 0-33 14.8-33 33v334c0 18.2 14.8 33 33 33h2zM663 774.7c18.1 0 33-14.8 33-33v-334c0-18.1-14.9-33-33-33h-2c-18.1 0-33 14.8-33 33v334c0 18.2 14.8 33 33 33h2z" p-id="3917"></path><path d="M812 280.7c-13.3 0-24 10.7-24 24v530c0 41.9-34.1 76-76 76H312c-41.9 0-76-34.1-76-76v-530c0-13.3-10.7-24-24-24s-24 10.7-24 24v530c0 68.4 55.6 124 124 124h400c68.4 0 124-55.6 124-124v-530c0-13.2-10.7-24-24-24z" p-id="3918"></path>
			</svg>
		</div>`
}
var nowSelected = null;  // 标记当前选中分类
var storageNotes = localStorage.getItem('storageNotes')
if(storageNotes)
	storageNotes = JSON.parse(storageNotes);
else
	storageNotes = [
		{name: 'blue',tasks:[{ name: '蓝色的我是忧郁的', tag:['urgent']}]},
		{name: 'red',tasks:[{ name: '但我依旧向往着火红的太阳',tag:['insistent']}]},
		{name: 'green',tasks:[{ name: '因为它能让大地变得翠绿',tag:['helpful']}]},
		{name: 'orange',tasks:[{ name: '能让橘树长出嫩果',tag:['urgent','insistent','helpful']}]},
		{name: 'gray',tasks:[{ name: '能让我片刻忘却心里灰色的阴霾',tag:['urgent','insistent']}]},
		{name: 'peach',tasks:[{ name: '终于现在，遇见了桃红色的你',tag:['insistent','helpful']}]},
		{name: 'violet',tasks:[{ name: '我鼓起勇气对你说:“紫薯两块钱一斤”',tag:['urgent','helpful']}]}		
	];

// storageNotes 对象的存储格式如下：
// var storageNotes = [
// 	{
// 		name: '工作',
// 		tasks: [
// 			{ name: '任务1', tag: ['urgent','insistent','helpful'] },
// 			{ name: '任务2', tag: [ ] },
// 			...
// 		]
// 	},
// 	...
// ]

function addTask(obj){
	var note = obj.parentNode;
	if(SETTING.taskCount == SETTING.nowTask[note.getAttribute('data-index')]){
		alert('以达到最大数量，无法继续创建!');
		return;
	}
	var ul = note.getElementsByTagName('ul').item(0);
	var input = prompt('输入格式字符串：\n(内容-标记1-标记2-标记3)\n(示例：好好吃饭-urgent-insistent-helpful)');
	if(input){
		var li = document.createElement('li');
		var inputArray = input.split('-');
		li.innerHTML = baseDom.liInnerHtml.substr(0,25) + baseDom.liInnerHtml.substr(37) + inputArray[0];
		var tags = document.createElement('div');
		tags.setAttribute('class','tags');
		li.appendChild(tags);
		for(let i=1;i<inputArray.length;i++){
			var tag = document.createElement('span');
			tag.setAttribute('class',inputArray[i]);
			tags.appendChild(tag);
		}
		ul.appendChild(li);
		SETTING.nowTask[note.getAttribute('data-index')] ++;
		setEventForSVG();
	}
}
function createDomWithData(data,flag = 0){
	var notes = document.getElementsByClassName('notes').item(0);
	var note = document.createElement('div');
	note.setAttribute('class','note ' + SETTING.noteColor[SETTING.nowNote % SETTING.noteColor.length]);
	note.setAttribute('data-index',SETTING.nowNote);
	if(flag)
		note.innerHTML = baseDom.noteInnerHtml.substr(0,25) + baseDom.noteInnerHtml.substr(37);
	else
		note.innerHTML = baseDom.noteInnerHtml;
	notes.appendChild(note);
	var title = document.createElement('span');
	title.setAttribute('class','title');
	title.innerText = data.name;
	note.appendChild(title);
	var ul = document.createElement('ul');
	note.appendChild(ul);
	data.tasks.forEach(function(x){
		var li = document.createElement('li');
		li.innerHTML = baseDom.liInnerHtml + x.name;
		var tags = document.createElement('div');
		tags.setAttribute('class','tags');
		li.appendChild(tags);
		if(x.tag && x.tag.length){
			x.tag.forEach(function(y){
				var tag = document.createElement('span');
				tag.setAttribute('class',y);
				tags.appendChild(tag);
			})
		}
		ul.appendChild(li);
	});
	SETTING.nowNote ++;
	bindNoteEvent(note);
	setEventForSVG();
}
function addNote(){
	if(SETTING.noteCount == SETTING.nowNote){
		alert('以达到最大数量，无法继续创建!');
		return;
	}
	var title = prompt('输入新建条类的名称：');
	if(title){
		var note = {};
		note['name'] = title;
		note.tasks = [];
		createDomWithData(note,1);
	}
}
function deleteTask(obj){
	var li = obj.parentNode;
	var index = +li.parentNode.parentNode.getAttribute('data-index');
	SETTING.nowTask[index] --;
	li.parentNode.removeChild(li);
}
function deleteNote(obj){
	var parentObj = obj.parentNode;
	parentObj.parentNode.removeChild(parentObj);
	SETTING.nowNote --;
	if(parentObj == nowSelected){
		nowSelected = null;
	// 	nowSelected = document.getElementsByClassName('note').item(0);
	// 	toggleClass(nowSelected,'selected')
	}
}
function toggleSetNote(){
	var addButton = document.getElementsByClassName('addNote').item(0);
	toggleClass(addButton,'displayNone');
	var deleteButtons = document.getElementsByClassName('deleteNote');
	for(let x of deleteButtons){
		toggleClass(x,'displayNone');
	}
}
function toggleSetTask(obj){
	var ulObj = obj.parentNode.getElementsByTagName('ul').item(0);
	var deleteButton = ulObj.getElementsByClassName('deleteTask');
	var addButton = obj.parentNode.getElementsByClassName('addTask').item(0);
	toggleClass(addButton,'displayNone');
	for(let x of deleteButton){
		toggleClass(x,'displayNone');
	}
}
function toggleClass(domObject,className){
	var classArray = domObject.getAttribute("class").split(" ");
	var flag = false;
	classArray = classArray.filter(function(x){
		if( x == className){
			flag = true;
			return false;
		}
		return true;
	})
	if(!flag){
		classArray.push(className);
	}
	domObject.setAttribute('class',classArray.join(" "));
}
function setEventForSVG(){
	var SVGS = document.getElementsByTagName('svg');
	for(let x of SVGS){
		bindSVGEvent(x);
	}
}
function bindSVGEvent(x){
	x.addEventListener('mouseover',()=>{
		x.setAttribute('fill','#888');
	})
	x.addEventListener('mouseleave',()=>{
		x.setAttribute('fill','#111');
	})
}
function bindNoteEvent(x){
	x.addEventListener('mouseover',()=>{
		if(x != nowSelected){
			if(nowSelected)
				toggleClass(nowSelected,'selected');
			toggleClass(x,'selected');
			nowSelected = x;
		}
	})
}
function countAll(){
	SETTING.nowNote = storageNotes.length;
	storageNotes.forEach(function(x,i){
		SETTING.nowTask[i] = x.tasks.length;
	})
	nowSelected = document.getElementsByClassName('note').item(0);
	toggleClass(nowSelected,'selected')
}
window.onload = function(){
	storageNotes.forEach((x)=>{
		createDomWithData(x);
	})
	countAll();
}
window.onbeforeunload = function(){
	var notesData = [];
	var notes = document.getElementsByClassName('note');
	for(let x of notes){
		var noteData = {};
		noteData['name'] = x.getElementsByClassName('title').item(0).innerText;
		noteData['tasks'] = [];
		var li = x.getElementsByTagName('li');
		for(let y of li){
			var taskData = {};
			taskData['name'] = y.innerText;
			taskData['tag'] = [];
			var tags = y.querySelectorAll('.tags span')
			for(let z of tags){
				taskData['tag'].push(z.getAttribute('class'));
			}
			noteData['tasks'].push(taskData);
		}
		notesData.push(noteData);
	}
	localStorage.setItem('storageNotes',JSON.stringify(notesData));
}
</script>
</body>
</html>